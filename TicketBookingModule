#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>
#pragma warning (disable:4996)

typedef struct {
	char bookingID[10], memberID[6], trainID[6], bookingDate[11], departDate[11],
		departStation[40], arriveStation[40], paymentType, ticketStatus;
	int coachNo, seatNo, quantity;
	float paymentAmt;
}TrainTicket;

//bookingID memberID trainID bookingDate departDate seatNo coachNo quantity paymentType paymentAmt ticketStatus
//departStation arriveStation

void bookingMain();
void bookTicket();
void checkTicketStatus();
void editBooking();
void cancelBooking();
void displayBookedTickets();
void report();

void main() {
	int choice = 0, login = 1;
	//'login' is an identifier to determine if the customer has logged in as a member or not
	//'login' = 0 means havent log in, 1 means logged in
	bookingMain();
	rewind(stdin);
	scanf("%d", &choice);

	switch (choice) {
	case 1: 
		if (login == 1) {
			bookTicket();

		};
		break;
	case 2:
		break;
	}

}

void bookingMain() {
	printf("Thank you for using XXX train!              \n");
	printf("--------------------------------------------\n");
	printf("|              Ticket Booking              |\n");
	printf("============================================\n");
	printf("[1] Book ticket                             \n");
	printf("[2] Check ticket status                     \n");
	printf("[3] Edit booking                            \n");
	printf("[4] Cancel booking                          \n");
	printf("[5] Display booked tickets (staff only)     \n");
	printf("[6] Report (staff only)                     \n");
	printf("[7] Return to main menu                     \n\n");
	printf("Press 0 to exit program                     \n");
	printf("Select your option (1-7): ");
};

void bookTicket() {
	system("cls");

	TrainTicket ticket[50];

	char bookingID[6], memberID[6], trainID[6], bookingDate[11], departDate[11],
		departStation[40], arriveStation[40], paymentType, ticketStatus;
	int coachNo, seatNo, quantity, day, month, year;
	float paymentAmt;

	//declarations here

	FILE* bookTicket;
	bookTicket = fopen("BookedTickets.txt", "a");

	//if no file found, exit program
	if (bookTicket == NULL) {
		printf("No file found. Please create file.");
		exit(-1);
	}

	printf("---------------------------------\n");
	printf("|         Book tickets          |\n");
	printf("=================================\n");
	printf("Insert member ID: ");
	rewind(stdin);
	scanf("%[^\n]", memberID);
	while (memberID[0] != 'M' || isdigit(memberID[1]) == 0 || isdigit(memberID[2]) == 0
		|| isdigit(memberID[3]) == 0 || isdigit(memberID[4]) == 0) {
		printf("Invalid format, please enter again.\n");
		printf("Insert member ID: ");
		rewind(stdin);
		scanf("%[^\n]", memberID);
	}
	printf("Insert booking date (DD-MM-YYYY):\n");
	rewind(stdin);
	scanf("%d-%d-%d", &day, &month, &year);
	while (!(day >= 0) || !(day <= 31) || !(month >= 0) || !(month <= 12) || !(year >= 2024) || !(year <= 2026)) {
		printf("Invalid date format, please enter again.\n");
		printf("Insert booking date (DD-MM-YYYY):\n");
		rewind(stdin);
		scanf("%d-%d-%d", &day, &month, &year);
	}

}

void checkTicketStatus() {

}

void editBooking() {

}

void cancelBooking() {

}

void displayBookedTickets() {

}

void report() {

}
